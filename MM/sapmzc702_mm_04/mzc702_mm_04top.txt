*&---------------------------------------------------------------------*
*& Include MZC702_MM_04TOP                          - Module Pool      SAPMZC702_MM_04
*&---------------------------------------------------------------------*
PROGRAM SAPMZC702_MM_04.


* 수불대장 관리 테이블 사용.
TABLES: ZTC702_SRMANAGE, ZDVC702_MPO, ZTC702_MTMASTER, ZTC702_PRDMANAGE, ZTC702_REOR_I, ZTC702_EXP, ZDVC702_SRM, ZTC702_MTIV.

* 데이터 오브젝트 정의.
DATA: OK_CODE    LIKE SY-UCOMM,
      GV_REFRESH TYPE C LENGTH 1,
      GV_REFRESH2 TYPE C LENGTH 1,
      GV_SWITCH  TYPE C LENGTH 1 VALUE '1',
      GV_SWITCH2 TYPE C LENGTH 1.

* 인터널 테이블 정의.
TYPES: BEGIN OF GTY_TABLE.
    INCLUDE TYPE ZTC702_SRMANAGE.
TYPES: COLOR TYPE C LENGTH 4,
       TNAME TYPE C LENGTH 4,
       END OF GTY_TABLE.

DATA: GT_TABLE  TYPE TABLE OF GTY_TABLE,
      GS_TABLE  TYPE GTY_TABLE,
      GT_SCREEN TYPE TABLE OF GTY_TABLE,
      GS_SCREEN TYPE GTY_TABLE.

TYPES: BEGIN OF GTY_TABLE2.
    INCLUDE TYPE ZDVC702_SRM.
TYPES: COLOR    TYPE C LENGTH 4,
       SRTYPE_T TYPE C LENGTH 4,
       END OF GTY_TABLE2.

DATA: GT_TABLE2  TYPE TABLE OF GTY_TABLE2,
      GS_TABLE2  TYPE GTY_TABLE2,
      GS_SCREEN2 TYPE GTY_TABLE2.

TYPES: BEGIN OF GTY_MPO.
    INCLUDE TYPE ZDVC702_MPO.
TYPES: COLOR TYPE C LENGTH 4,
       END OF GTY_MPO.

DATA: GT_MPO TYPE TABLE OF GTY_MPO,
      GS_MPO TYPE GTY_MPO.

TYPES: BEGIN OF GTY_PRD.
    INCLUDE TYPE ZTC702_PRDMANAGE.
TYPES: COLOR TYPE C LENGTH 4,
       END OF GTY_PRD.

DATA: GT_PRD TYPE TABLE OF GTY_PRD,
      GS_PRD TYPE GTY_PRD.

TYPES: BEGIN OF GTY_REOR.
    INCLUDE TYPE ZTC702_REOR_I.
TYPES: COLOR TYPE C LENGTH 4,
       END OF GTY_REOR.

DATA: GT_REOR TYPE TABLE OF GTY_REOR,
      GS_REOR TYPE GTY_REOR.

TYPES: BEGIN OF GTY_EXP.
    INCLUDE TYPE ZTC702_EXP.
TYPES: GDNAME TYPE ZTC702_MTMASTER-GDNAME,
       END OF GTY_EXP.

DATA: GT_EXP TYPE TABLE OF GTY_EXP,
      GS_EXP TYPE GTY_EXP.

TYPES: BEGIN OF GTY_MTIV.
    INCLUDE TYPE ZTC702_MTIV.
TYPES: GDNAME TYPE ZTC702_MTMASTER-GDNAME,
       END OF GTY_MTIV.

DATA: GT_MTIV TYPE TABLE OF GTY_MTIV,
      GS_MTIV TYPE GTY_MTIV.

DATA: GV_RA1 TYPE C LENGTH 1 VALUE 'X',
      GV_RA2 TYPE C LENGTH 1,
      GV_RA3 TYPE C LENGTH 1,
      GV_RA4 TYPE C LENGTH 1,
      GV_RA5 TYPE C LENGTH 1,
      GV_RA6 TYPE C LENGTH 1,
      GV_LOW LIKE SY-DATUM,
      GV_HIG LIKE SY-DATUM.

* ALV GRID 정의.
DATA: GO_CONTAINER TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV_GRID  TYPE REF TO CL_GUI_ALV_GRID.

DATA: GO_CONTAINER2 TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV_GRID2  TYPE REF TO CL_GUI_ALV_GRID.

DATA: GO_CONTAINER3 TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
      GO_ALV_GRID3  TYPE REF TO CL_GUI_ALV_GRID.


*************************************TREE ALV
TYPES: NODE_TABLE_TYPE  LIKE STANDARD TABLE OF MTREESNODE WITH DEFAULT KEY.

DATA: TREE_CON_REF TYPE REF TO CL_GUI_CUSTOM_CONTAINER, "컨테이너 만들기
      G_TREE       TYPE REF TO CL_GUI_SIMPLE_TREE.        "트리 컨테이너 참조변수


DATA: WS_TAB  TYPE ZTC702_DISPOSAL,
      WT_TAB  TYPE TABLE OF ZTC702_DISPOSAL,
      WT_TAB2 TYPE TABLE OF ZTC702_DISPOSAL. " 트리에서 사용되는 인터널 테이블 선언

**************************************

* ALV GRID 변수 선언.
DATA: GS_VARIANT TYPE DISVARIANT.

* ALV GRID 버튼 숨기기 함수.
DATA: GT_EXCLUDE TYPE UI_FUNCTIONS.

* ALV GRID 화면 편집 변수.
DATA: GS_LAYOUT      TYPE LVC_S_LAYO,
      GS_FIELD_COLOR TYPE LVC_S_SCOL,
      GT_FIELD_CAT   TYPE LVC_T_FCAT,
      GS_FIELD_CAT   TYPE LVC_S_FCAT,
      GT_FIELD_CAT2  TYPE LVC_T_FCAT,
      GS_FIELD_CAT2  TYPE LVC_S_FCAT,
      GT_FIELD_CAT3  TYPE LVC_T_FCAT,
      GS_FIELD_CAT3  TYPE LVC_S_FCAT.

* 이벤트 구현.
CLASS LCL_APPLICATION DEFINITION.
  PUBLIC SECTION.
    METHODS : HANDLE_NODE_DOUBLE_CLICK
                  FOR EVENT NODE_DOUBLE_CLICK OF CL_GUI_SIMPLE_TREE " 트리에 노드 더블 클릭시 해당 ALV나옴.
      IMPORTING NODE_KEY.
ENDCLASS.
CLASS LCL_APPLICATION IMPLEMENTATION.
  METHOD HANDLE_NODE_DOUBLE_CLICK.
    PERFORM NODE_DOUBLE_CLICK_0100  USING NODE_KEY.
  ENDMETHOD.

ENDCLASS.

DATA: G_APPLICATION TYPE REF TO LCL_APPLICATION.

----------------------------------------------------------------------------------
Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2023. Sap Release 751
